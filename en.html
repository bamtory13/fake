<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>쎈답지 인증</title>
    <style>
        body { font-family: sans-serif; text-align: center; padding-top: 50px; line-height: 1.6; overflow-x: hidden; }
        .status { margin-top: 15px; color: #555; font-weight: bold; min-height: 24px; }
        .error { color: red; }
        .success { color: green; }
        
        .check-area { 
            margin-bottom: 25px; 
            padding: 15px; 
            background-color: #f9f9f9; 
            display: inline-block; 
            border-radius: 8px;
            border: 1px dashed #ccc;
        }
        
        input[type="text"] {
            padding: 10px;
            font-size: 16px;
            width: 250px;
            border: 1px solid #ccc;
            border-radius: 5px;
            margin-bottom: 10px;
        }
        
        button { padding: 10px 20px; cursor: pointer; font-size: 16px; border: none; border-radius: 5px; }
        
        #verifyBtn { 
            background-color: #007BFF; 
            color: white; 
            position: relative; 
            transition: 0.1s; 
            touch-action: none; 
        }
        
        #nextBtn { background-color: #4CAF50; color: white; margin-top: 10px; }
        
        .input-group { margin: 20px 0; }
        label { cursor: pointer; font-weight: bold; }

        .loader-container { 
            width: 280px; 
            background: #eee; 
            height: 12px; 
            border-radius: 6px; 
            margin: 20px auto; 
            display: none; 
            overflow: hidden; 
            border: 1px solid #ccc;
        }
        .loader-bar { width: 0%; height: 100%; background: #007BFF; transition: width 0.4s; }
    </style>
</head>
<body>

    <h1>쎈 답지 인증</h1>
    
    <div class="check-area">
        <input type="checkbox" id="humanCheck"> 
        <label for="humanCheck">사람이 맞습니까?</label>
    </div>

    <p>아래 박스에 "<strong>정민균은 잘생겼다</strong>"라고 입력해주세요.</p>
    
    <div class="input-group">
        <input type="text" id="userInput" placeholder="문구를 입력하세요" autocomplete="off">
        <br>
        <button id="verifyBtn">인증하기</button>
    </div>

    <div class="loader-container" id="loader">
        <div class="loader-bar" id="loaderBar"></div>
    </div>

    <div id="statusMsg" class="status"></div>

    <button id="nextBtn" onclick="location.href='index.html'" style="display:none;">답지 보러가기</button>

    <script>
        const verifyBtn = document.getElementById('verifyBtn');
        const userInput = document.getElementById('userInput');
        const humanCheck = document.getElementById('humanCheck');
        const nextBtn = document.getElementById('nextBtn');
        const statusMsg = document.getElementById('statusMsg');
        const loader = document.getElementById('loader');
        const loaderBar = document.getElementById('loaderBar');

        const targetText = "정민균은잘생겼다";
        let escapeCount = 0; 
        const maxEscapes = 10; 

        const escape = (e) => {
            if (escapeCount < maxEscapes) {
                escapeCount++;
                const x = Math.random() * (window.innerWidth - verifyBtn.clientWidth);
                const y = Math.random() * (window.innerHeight - verifyBtn.clientHeight);
                verifyBtn.style.position = 'fixed';
                verifyBtn.style.left = x + 'px';
                verifyBtn.style.top = y + 'px';
                statusMsg.innerText = `10번안에 클릭 못하면 니얼굴 이재준... (${escapeCount}/${maxEscapes})`;
                statusMsg.className = "status error";
                if (e.type === 'touchstart') e.preventDefault(); 
            }
        };

        verifyBtn.addEventListener('mouseover', escape);
        verifyBtn.addEventListener('touchstart', escape);

        verifyBtn.addEventListener('click', () => {
            if (escapeCount < maxEscapes) return;

            if (!humanCheck.checked) {
                statusMsg.innerText = "항목에 체크해 주세요!";
                statusMsg.className = "status error";
                return;
            }

            const cleanInput = userInput.value.replace(/\s/g, "");
            if (cleanInput === targetText) {
                verifyBtn.style.display = "none";
                document.querySelector('.input-group').style.display = "none";
                document.querySelector('.check-area').style.display = "none";
                
                loader.style.display = "block";
                statusMsg.innerText = "서버 연결 중...";

                let progress = 0;
                const interval = setInterval(() => {
                    progress += Math.random() * 5;
                    if (progress >= 99) {
                        progress = 99.9;
                        loaderBar.style.width = "99.9%";
                        statusMsg.innerText = "서버 응답 대기 중... (99.9%)";
                        clearInterval(interval);

                        // 여기서 30초(30000ms) 동안 대기
                        setTimeout(() => {
                            loaderBar.style.width = "100%";
                            statusMsg.innerText = "인증 성공!";
                            statusMsg.className = "status success";
                            nextBtn.style.display = "inline-block";
                        }, 30000); 
                    } else {
                        loaderBar.style.width = progress + "%";
                        statusMsg.innerText = `인증 진행 중... ${Math.floor(progress)}%`;
                    }
                }, 150);
            } else {
                statusMsg.innerText = "문구가 올바르지 않습니다.";
                statusMsg.className = "status error";
            }
        });
    </script>
</body>
</html>